#!/bin/bash

# Function to restart the app
restart_app() {
    echo "Refreshing app..."
    pkill -f "python -B main.py"  # Kill the existing app
    source venv/bin/activate && python -B main.py &           # Restart the app
}

# Infinite loop to reload the app
while true; do
    # Run the Kivy app initially
    source venv/bin/activate && python -B main.py &
    APP_PID=$!

    # Wait for user input (CTRL+C to exit, CTRL+R to refresh)
    while true; do
        read -rsn1 input  # Read a single character without waiting for Enter
        if [[ $input == $'\x03' ]]; then  # CTRL+C
            echo "CTRL+C detected, exiting loop."
            kill $APP_PID  # Kill the app if CTRL+C is pressed
            break 2  # Break out of both loops
        elif [[ $input == $'\x12' ]]; then  # CTRL+R
            restart_app  # Refresh the app
        fi
    done
done
